---
title: "Contrasts"
author: "Peter von Rohr"
date: "2023-03-27"
output: beamer_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Contrasts

* Linear combination of parameters
* In R used to determine which estimable functions are shown as factor level effects


## Example Dataset

```{r tbl-flem-bw-breed, echo=FALSE, message=FALSE, warning=FALSE}
library(dplyr)
s_data_dir <- file.path(here::here(), "docs", "data")
s_flem_path <- file.path(s_data_dir, "asm_bw_flem.csv")
tbl_flem <- readr::read_csv(file = s_flem_path)
tbl_flem_bw_breed <- tbl_flem %>% 
  select(Animal, `Body Weight`, Breed) 
knitr::kable(tbl_flem_bw_breed,
             booktabs = TRUE,
             longtable = FALSE,
             caption = "Body Weight and Breed of Beef Cattle Animals",
             escape = FALSE)
```


## Contrasts in R

```{r, echo=TRUE}
(mat_ctr <- contrasts(as.factor(tbl_flem_bw_breed$Breed)))
```


## Model Matrix

```{r, echo=TRUE}
model.matrix(lm(`Body Weight` ~ Breed, data = tbl_flem_bw_breed))
```


## Estimable Functions

* extend contrasts matrix by one row of all ones for the intercept

```{r}
(mat_ctr_ext <- cbind(matrix(rep(1,nrow(mat_ctr)),ncol = 1), mat_ctr))
```


## Estimable Functions II

* Inverse of extended contrasts matrix

```{r}
(mat_est_fun <- solve(mat_ctr_ext))
```

* First row: which group means are used for intercept
* Other rows: vectors $q^T$ representing estimable functions


## Validation

...


## Other Contasts

* Helmert
* sum


## Custom Contrasts



