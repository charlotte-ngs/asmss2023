---
title: Applied Statistical Methods - Notebook 5
author: Peter von Rohr
date: '2023-04-24'
output: html_notebook
params:
  doctype:
    label: Document Type
    value: solution
    choices:
    - exercise
    - solution
    - notebook
  isonline:
    label: Online (y/n)
    value: true
    choices:
    - true
    - false
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Problem 1: Interactions
Use the following dataset on `Breed`, `Breast Circumference` and `Body Weight` and fit a fixed linear effects model with `Body Weight` as response and `Breed` and `Breast Circumference` as predictors and include an interaction term between the two predictors. Compute the expected difference in `Body Weight` for two animals which differ in `Breast Circumference by $1cm$ for every `Breed`. 

The dataset is available under

```{r tbl-ex05-p01, echo=FALSE}
s_tbl_ex05_p01_path <- "https://charlotte-ngs.github.io/asmss2023/data/asm_bw_flem.csv"
s_tbl_ex05_p01_path
```


### Your Solution

* Read the data
* Fit fixed linear effects model for Body Weight using `Breed` and `Breast Circumference` and the interaction with function `lm()`
* From the solution of the `summary()` of the `lm()` result get the regression coefficient and the interaction effects and compute the expected difference in `Body Weight` for all three breeds. 





## Problem 2: Simulation
```{r, echo=FALSE, message=FALSE, warning=FALSE}
n_b_intercept <- -1070
n_b_slope <- 8.7
n_res_std_error <- 12
n_nr_obs <- 10
n_slope_tol <- 0.1

# take the values for mean and sd for bc from the dataset
s_tbl_bw_bc_br_path <- "https://charlotte-ngs.github.io/asmss2023/data/asm_bw_flem.csv"
tbl_bw_bc_br <- readr::read_delim(s_tbl_bw_bc_br_path, delim = ",")
n_mean_bc <- round(mean(tbl_bw_bc_br$`Breast Circumference`), 0)
n_sd_bc <- round(sd(tbl_bw_bc_br$`Breast Circumference`), 2)
```

Use the following values for intercept and regression slope for `Body Weight` on `Breast Circumference` to simulate a dataset of size $N$. What is the number for $N$ that has to be chosen such that the regression analysis of the simulated data gives the same result as the true regression slope. 

The true values are: 

* Intercept: $`r n_b_intercept`$
* Regression slope: $`r n_b_slope`$
* Residual standard error: $`r n_res_std_error`$

### Hints

* Start with $N=`r n_nr_obs`$, simulate a dataset and analyse the data with `lm()`
* If the result (rounded to 1 digits after decimal point) is not the same then double the size of the dataset, hence use, $N=`r 2*n_nr_obs`$
* Continue until you get close to the true value.
* Assume that the random resiudals follow a normal distribution with mean zero and standard devation equal to $`r n_res_std_error`$
* Take breast circumference to be normally distributed with a mean of $`r n_mean_bc`$ and a standard deviation of $`r n_sd_bc`$
* Use a linear regression model with an intercept to model expected body weight based on breast circumference.


### Your Solution

* Start with $N=`r n_nr_obs`$, simulate a dataset and analyse the data with `lm()`
* If the result (rounded to 1 digits after decimal point) is not the same then double the size of the dataset, hence use, $N=`r 2*n_nr_obs`$
* Continue until you get close to the true value.








```{r, echo=FALSE, results='asis'}
cat('\n---\n\n _Latest Changes: ', format(Sys.time(), '%Y-%m-%d %H:%M:%S'), ' (', Sys.info()['user'], ')_\n', sep = '')
```
 
